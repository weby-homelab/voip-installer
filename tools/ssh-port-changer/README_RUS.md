# üõ°Ô∏è SSH Port Changer `v1.0` (RU)

> **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–º–µ–Ω–∞ –ø–æ—Ä—Ç–∞ SSH –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö Ubuntu –±–µ–∑ —Ä–∏—Å–∫–∞ –ø–æ—Ç–µ—Ä–∏ –¥–æ—Å—Ç—É–ø–∞.**

[![Ubuntu](https://img.shields.io/badge/Ubuntu-24.04%2B-E95420?logo=ubuntu&style=flat-square)](https://ubuntu.com/)
[![Bash](https://img.shields.io/badge/Language-Bash-4EAA25?logo=gnu-bash&style=flat-square)](https://www.gnu.org/software/bash/)
[![License](https://img.shields.io/badge/License-MIT-blue?style=flat-square)](LICENSE)

---

## üöÄ –ü–æ—á–µ–º—É —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç?

–í **Ubuntu 24.04 LTS** –∏ –Ω–æ–≤–µ–µ —Å–º–µ–Ω–∞ –ø–æ—Ä—Ç–∞ SSH –±–æ–ª—å—à–µ –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç—ã–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º `/etc/ssh/sshd_config`. Canonical –ø–µ—Ä–µ—à–ª–∞ –Ω–∞ **Systemd Socket Activation**, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∏–º–µ–Ω–Ω–æ `ssh.socket` —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ—Ä—Ç–æ–º –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à–µ–≥–æ –∫–æ–Ω—Ñ–∏–≥-—Ñ–∞–π–ª–∞.

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –±–µ—Ä–µ—Ç –≤—Å—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞ —Å–µ–±—è, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è **–±–µ–∑–æ–ø–∞—Å–Ω—É—é —Å–º–µ–Ω—É –ø–æ—Ä—Ç–∞ –±–µ–∑ –ø—Ä–æ—Å—Ç–æ—è**.

### ‚ú® –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

*   **üõ°Ô∏è –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã–π –ø–µ—Ä–µ—Ö–æ–¥:** –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω —Å–ª—É—à–∞–ª **–û–ë–ê** –ø–æ—Ä—Ç–∞ (—Å—Ç–∞—Ä—ã–π –∏ –Ω–æ–≤—ã–π) –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤–æ –≤—Ä–µ–º—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
*   **üîå Systemd Socket Override:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è `listen.conf` –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ —Å–æ–∫–µ—Ç–æ–≤.
*   **üß± –ê–≤—Ç–æ-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firewall:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç **NFTables** –∏–ª–∏ **UFW**.
*   **üö´ –ó–∞—â–∏—Ç–∞ –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:** –°–∫—Ä–∏–ø—Ç –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∏ —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –≤—ã –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ, –ø—Ä–µ–∂–¥–µ —á–µ–º –∑–∞–∫—Ä—ã—Ç—å —Å—Ç–∞—Ä—ã–π –ø–æ—Ä—Ç.
*   **ü§ñ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Fail2Ban:** –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞—â–∏—Ç—ã (jails) –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–æ–≤–æ–≥–æ –ø–æ—Ä—Ç–∞.

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ –Ω–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º `root`:

```bash
# –°–∫–∞—á–∞—Ç—å –∏ —Å–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
curl -fsSL https://raw.githubusercontent.com/weby-homelab/voip-installer/main/tools/ssh-port-changer/change_port.sh -o change_port.sh
chmod +x change_port.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç—å (–∑–∞–º–µ–Ω–∏—Ç–µ 54322 –Ω–∞ –≤–∞—à –ø–æ—Ä—Ç)
sudo ./change_port.sh 54322
```

---

## üìñ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º
–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, —á—Ç–æ–±—ã —Å–∫—Ä–∏–ø—Ç —Å–∞–º —Å–ø—Ä–æ—Å–∏–ª –ø–æ—Ä—Ç:
```bash
./change_port.sh
# > Enter new SSH port (1024-65535):
```

### 2. –ù–µ–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º
–ü–µ—Ä–µ–¥–∞–π—Ç–µ –ø–æ—Ä—Ç –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏:
```bash
./change_port.sh 2222
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —à–∞–≥)
–°–∫—Ä–∏–ø—Ç –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ:

> **–ö–†–ò–¢–ò–ß–ù–û: –ù–ï –ó–ê–ö–†–´–í–ê–ô–¢–ï –¢–ï–ö–£–©–£–Æ –°–ï–°–°–ò–Æ!**
> –û—Ç–∫—Ä–æ–π—Ç–µ –ù–û–í–û–ï –æ–∫–Ω–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:
> `ssh -p 54322 root@<–≤–∞—à-ip>`

**–¢–æ–ª—å–∫–æ** –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã —É—Å–ø–µ—à–Ω–æ –≤–æ—à–ª–∏ —á–µ—Ä–µ–∑ –Ω–æ–≤—ã–π –ø–æ—Ä—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –æ–∫–Ω–µ, –≤–≤–µ–¥–∏—Ç–µ `yes` –≤ —Å–∫—Ä–∏–ø—Ç–µ, —á—Ç–æ–±—ã –∑–∞–≤–µ—Ä—à–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è (–∑–∞–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç 22).

---

## üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1.  **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ root –∏ –≤–µ—Ä—Å–∏–∏ –û–°.
2.  **Firewall:** –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–∞—é—â–µ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –ù–û–í–û–ì–û –ø–æ—Ä—Ç–∞.
3.  **Socket Dual-Bind:** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `ssh.socket` –Ω–∞ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ 22 –ò –Ω–æ–≤–æ–≥–æ –ø–æ—Ä—Ç–∞.
4.  **–û–∂–∏–¥–∞–Ω–∏–µ:** –ü–∞—É–∑–∞ –¥–ª—è —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
5.  **–û—á–∏—Å—Ç–∫–∞:**
    *   –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞ 22 –∏–∑ `ssh.socket`.
    *   –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `sshd_config` (–¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤).
    *   –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—é—Ä–µ–º `fail2ban`.
    *   –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞ 22 –∏–∑ –ø—Ä–∞–≤–∏–ª Firewall.

---

## üì¶ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

| –û–° | –í–µ—Ä—Å–∏—è | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| :--- | :--- | :--- | :--- |
| **Ubuntu** | 24.04 LTS (Noble) | ‚úÖ –ü–æ–ª–Ω–∞—è | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–≥–∏–∫—É `ssh.socket` |
| **Ubuntu** | 22.04 LTS | ‚ö†Ô∏è –ù–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å | –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å, –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω socket activation |
| **Debian** | 12 (Bookworm) | ‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `sshd_config` |

---

## ü§ù –£—á–∞—Å—Ç–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

–ù–∞—à–ª–∏ –±–∞–≥? –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∫–ª–∞–¥–∫—É [Issues](https://github.com/weby-homelab/voip-installer/issues).
–ü—É–ª-—Ä–µ–∫–≤–µ—Å—Ç—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!

**–õ–∏—Ü–µ–Ω–∑–∏—è:** MIT
